{% extends "base.html" %}
{% block content %}
    <h3 class="alert alert-info text-center">Medicine Master</h3>
  <div class ="container mt-3">
    {% for message in messages %}
    <p class="alert alert-success mt-3">{{message}}</p>
    {% endfor %}
</div>
  {% if sel_items %}
    <form action="{% url 'hiapp:update_item' sel_items.id %}" method="post">
  {% csrf_token %}
        <div class ="container mt-3">
      <div class="col-md-12">
        <div class="form-row">
    <div class="form-group col-md-3">
      <label for="itemname">Medicine Name</label>
      <input type="text" class="form-control" name="itemname" id="itemname" value="{{ sel_items.itemname }}"placeholder="Medicine Name">
    </div>
    <div class="form-group col-md-3">
      <label for="itemcode">Batch No</label>
      <input type="text" class="form-control" name="itemcode" placeholder="Batch No" value="{{ sel_items.itemcode }}">
    </div>
      <div class="form-group col-md-3">
      <label for="category">Category</label>
     <select class="form-control" name="category" value="{{ sel_items.category_id }}">
        <option value="">Select a Category</option>
        {% for category in categories %}
          <option value="{{ category.id }}" {% if category.id == sel_items.category_id %}selected{% endif %}>{{ category.categoryname }}</option>
        {% endfor %}
      </select>
     </div>
    <div class="form-group col-md-3">
      <label for="salestax">Sales Tax</label>
      <input type="number" class="form-control" name="salestax" placeholder="Sales Tax" value="{{ sel_items.salestax }}">
    </div>

     <div class="form-group col-md-3">
      <label for="mrp">MRP</label>
      <input type="text" class="form-control" name="mrp" placeholder="Item MRP" value="{{ sel_items.mrp }}">
    </div>
     <div class="form-group col-md-3">
      <label for="barcode">Barcode</label>
      <input type="text" class="form-control" name="barcode" placeholder="BarCode" value="{{ sel_items.barcode }}">
    </div>
    <div class="form-group col-md-3">
      <label for="hsncode">HsnCode</label>
      <input type="text" class="form-control" name="hsncode" placeholder="HsnCode" value= "{{ sel_items.hsncode }}">
    </div>
    <div class="form-group col-md-3">
      <label for="unit">Unit</label>
      <select name="unit" id="unit" class="form-control" value="{{ sel_items.unit }}">
        <option value="Nos.">Nos.</option>
        <option value="Kg">Kg</option>
        <option value="Ltr">Ltr</option>
        <option value="Pkts">Packets</option>
        <option value="Box">Boxes</option>
        <option value="mtr">Meter</option>
        <option value="dozen">Dozen</option>
        <option value="pieces">Pieces</option>
      </select>
    </div>

     <div class="form-group col-md-3">
      <label for="brand">Brand</label>
     <select class="form-control" name="brand" >
        <option value="">Select a Brand</option>
        {% for brand in brands %}
          <option value="{{ brand.id }}"{% if brand.id == sel_items.brand_id %}selected{% endif %}>{{ brand.brandname }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="form-group col-md-3">
      <label for="purchasetax">Purchase Tax</label>
        <input type="number" class="form-control" id= purchasetax name="purchasetax" class="form-control" placeholder="Purchase Tax" value="{{ sel_items.purchasetax }}">
    </div>
     <div class="form-group col-md-3">

<button type="submit" class="btn btn-primary">Update Item</button>
  </div>
        </div>
      </div></div>
  </form>
    {% else %}
    <form action="{% url 'hiapp:add_item' %}" method="post">
                    {% csrf_token %}
        <div class="container mt-3">
       <div class="form-row">
       <div class="form-group col-md-3">
      <label for="itemname">Medicine Name</label>
      <input type="text" class="form-control" name="itemname" id="itemname" placeholder="Medicine Name">
    </div>
    <div class="form-group col-md-3">
      <label for="itemcode">Batch No</label>
      <input type="text" class="form-control" name="itemcode" placeholder="Batch No">
    </div>
     <div class="form-group col-md-3">
      <label for="category">Category</label>
     <select class="form-control" name="category">
        <option value="">Select a Category</option>
        {% for category in categories %}
          <option value="{{ category.id }}">{{ category.categoryname }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="form-group col-md-3">
      <label for="salestax">Sales Tax</label>
       <input type="number" class="form-control" name="salestax" placeholder="Sales Tax">
    </div>
     <div class="form-group col-md-3">
      <label for="mrp">MRP</label>
      <input type="text" class="form-control" name="mrp" placeholder="Item MRP">
    </div>
     <div class="form-group col-md-3">
      <label for="barcode">Barcode</label>
      <input type="text" class="form-control" name="barcode" placeholder="BarCode">
    </div>

    <div class="form-group col-md-3">
      <label for="hsncode">HsnCode</label>
      <input type="text" class="form-control" name="hsncode" placeholder="HsnCode">
    </div>
    <div class="form-group col-md-3">
      <label for="unit">Unit</label>
      <select name="unit" id="unit" class="form-control">
        <option value="Nos.">Nos.</option>
        <option value="Kg">Kg</option>
          <option value="Gm">Gm</option>
        <option value="Ltr">Ltr</option>
          <option value="Milli Litre">Milli Litre</option>
        <option value="Pkts">Packets</option>
        <option value="Box">Boxes</option>
        <option value="mtr">Meter</option>
          <option value="centimtr">Centi Meter</option>
          <option value="set">Set</option>
        <option value="dozen">Dozen</option>
        <option value="pieces">Pieces</option>
      </select>
    </div>
     <div class="form-group col-md-3">
      <label for="brand">Brand</label>
     <select class="form-control" name="brand">
        <option value="">Select a Brand</option>
        {% for brand in brands %}
          <option value="{{ brand.id }}">{{ brand.brandname }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="form-group col-md-3">
      <label for="purchasetax">Purchase Tax</label>
         <input type="number" class="form-control" name="purchasetax" placeholder="Purchase Tax">
        </div>
    <div class="form-group col-md-3">
<button type="submit" class="btn btn-success">Add Item</button>
    </div>
       </div>
        </div>
 </form>
{% endif %}
     <h3 class="alert alert-info text-center">Show Medicine Information</h3>
  <div class="container mt-3" style="max-height: 300px; overflow-y: auto;">
    <table class="table table-bordered">
      <thead>
      <tr>
        <th scope="col">Sl.no</th>
        <th scope="col">Batch No</th>
        <th scope="col">Medicine Name</th>
          <th scope="col">HSN</th>
           <th scope="col">Unit</th>
        <th scope="col">MRP</th>
        <th scope="col">Sales Tax in %</th>
         <th scope="col">Purchase Tax in %</th>
          <th scope="col">Brand</th>
        <th scope="col">Category</th>

      </tr>
      </thead>
      <tbody>
      {% for i in item_list%}
      <tr data-item-id="{{ i.id }}">
        <td>{{forloop.counter}}</td>
        <td>{{i.itemcode}}</td>
        <td>{{i.itemname}}</td>
          <td>{{i.hsncode}}</td>
          <td>{{i.unit}}</td>
        <td class="mrp-cell">{{i.mrp}}</td>
        <td>{{i.salestax}}</td>
        <td>{{i.purchasetax}}</td>
          <td>{{i.brand}}</td>
        <td>{{i.category}}</td>
         <td><a href="{% url 'hiapp:edit_item' i.id %}" class="btn btn-warning btn-sm">Edit</a></td>
        <td><a href="{% url 'hiapp:delete_item' i.id %}" class="btn btn-danger btn-sm delete-button">Delete</a></td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
</div>
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const deleteButtons = document.querySelectorAll(".delete-button");
    deleteButtons.forEach(function (button) {
      button.addEventListener("click", function (event) {
        event.preventDefault();
        const confirmation = confirm("Are you sure you want to delete?");
        if (confirmation) {
          window.location = event.target.href;
        }
      });
    });
  });
</script>
{% endblock %}
